<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" media="screen" href="../public/css/screenStyle.css">
    <link rel="stylesheet" media="print" href="./public/css/printStyle.css">
    <title>Pop culture recipes!</title>
</head>

<body class="mainPageBody">
    <header>
        <h1 id='header'>Recipes from pop culture!<svg class="mainSvg" focusable="false" aria-hidden="true"
                style="height: 2rem; width: 2rem ;" viewBox="0 0 24 24">
                <path
                    d="M6.4 7c-.34.55-.4.97-.4 1.38C6 9.15 7 11 7 12c0 .95-.4 1.5-.4 1.5H5.1s.4-.55.4-1.5c0-1-1-2.85-1-3.62 0-.41.06-.83.4-1.38h1.5zm5 0c-.34.55-.4.97-.4 1.38 0 .77 1 2.62 1 3.62 0 .95-.4 1.5-.4 1.5h1.5s.4-.55.4-1.5c0-1-1-2.85-1-3.62 0-.41.06-.83.4-1.38h-1.5zM8.15 7c-.34.55-.4.97-.4 1.38 0 .77 1 2.63 1 3.62 0 .95-.4 1.5-.4 1.5h1.5s.4-.55.4-1.5c0-1-1-2.85-1-3.62 0-.41.06-.83.4-1.38h-1.5zm13.32-.5s.13-1.06.13-1.5c0-1.65-1.35-3-3-3-1.54 0-2.81 1.16-2.98 2.65L14.53 15H4.01c-.6 0-1.09.53-1 1.13C3.53 19.46 6.39 22 9.75 22c3.48 0 6.34-2.73 6.71-6.23L17.61 4.9c.05-.51.47-.9.99-.9.55 0 1 .45 1 1 0 .3-.1 1.25-.1 1.25l1.97.25z">
                </path>
            </svg></h1>
    </header>
    <nav class="mainNavigation">
        <ul>
            <li><a href='./articles/article1.html'>Milk steak</a></li>
            <li><a href="./articles/article2.html">Pan galactic gargle blaster</a></li>
            <li><a href="./articles/article3.html">Piemonade</a></li>
        </ul>
    </nav>
    <main>
        <span class="imgSection">
            <img src='fig/chef-boyardee.jpg' alt='a talented chef by the name of boyardee'>
        </span>
        <p>A collection of recipes from pop culture! Made by <i>Yurii Cherniak</i> <a
                href="mailto:yurii.cherniak@student.tuke.sk">yurii.cherniak@student.tuke.sk</a> </p>
    </main>
    <footer>
        <section>

            <form id="opnFrm">
                <div>
                    <label for="nameInp">Your name:</label>
                    <input type="text" placeholder="Name" id="nameInp" required />
                </div>
                <div>
                    <label for="emailInp">Your email:</label>
                    <input type="email" placeholder="Email" required id="emailInp" />
                </div>
                <div>
                    <label for="imgeInp">Image url:</label>
                    <input type="url" placeholder="Image url" id="imgInp" />
                </div>
                <div id="reccomendInp">
                    <legend>Will you reccomend our website to your friends?</legend>
                    <input type="radio" name="reccomend" id="yes" value="yes" checked>Yes
                    <input type="radio" name="reccomend" id="no" value="no">No
                </div>
                <div>
                    <input type="checkbox" id="willTryInp" name="tryed">
                    <label for="tryed">I will try one of these recipes in future</label>
                </div>
                <div>
                    <label for="review">Please enter your comment here:</label>
                    <textarea name="review" id="commentInp" required></textarea>
                </div>
                <div>
                    <label for="recipies-choice">Choose the best recipe:</label>
                    <input list="recipies-list" id="bestRecipInp" name="recipies-choice">

                    <datalist id="recipies-list">
                        <option value="Milk steak">
                        <option value="Pan galactic gargle blaster">
                        <option value="Piemonade">
                    </datalist>
                </div>
                <div>
                    <input type="submit" value="Submit">
                    <button type="reset">
                        Reset
                    </button>
                </div>
            </form>
        </section>

    </footer>
    <script>
        //--------------------------------------------------------------------------------------------------------------
        //data and localStorage handling at startup

        let opinions = [];

        if (localStorage.opinions) {
            opinions = JSON.parse(localStorage.opinions);
        }

        console.log(opinions);

        //--------------------------------------------------------------------------------------------------------------
        //Form processing functionality

        /*
        * Note:
        * For the sake of simplicity, here we use window.alert to display messages to the user
        * However, if possible, avoid them in the production versions of your web applications
        *
        */

        const myFrmElm = document.getElementById("opnFrm");

        myFrmElm.addEventListener
            ("submit", processOpnFrmData);

        function processOpnFrmData(event) {
            //1.prevent normal event (form sending) processing
            event.preventDefault();

            //2. Read and adjust data from the form (here we remove white spaces before and after the strings)
            const nameInp = document.getElementById("nameInp").value.trim();
            const emailInp = document.getElementById("emailInp").value.trim();
            const imgInp = document.getElementById("imgInp").value.trim();
            let reccomendInp;
            if (document.getElementById('yes').checked) {
                reccomendInp = document.getElementById('yes').value;
            }
            else if (document.getElementById('no').checked) {
                reccomendInp = document.getElementById('no').value;
            }
            const willTryInp = document.getElementById("willTryInp").checked;
            const commentInp = document.getElementById("commentInp").value.trim();
            const bestRecipInp = document.getElementById("bestRecipInp").value.trim();

            //3. Verify the data
            if (nameInp == "" || emailInp == "" || commentInp == "") {
                window.alert("Please, enter your name, email and comment");
                return;
            }

            //3. Add the data to the array opinions and local storage
            const newOpinion =
            {
                name: nameInp,
                email: emailInp,
                comment: commentInp,
                ...(imgInp && { imgUrl: imgInp }),
                ...(reccomendInp && { willRecomend: reccomendInp }),
                ...(willTryInp !== undefined && { willTry: willTryInp }),
                ...(bestRecipInp && { bestRecip: bestRecipInp }),
                created: new Date()
            };

            console.log("New opinion:\n " + JSON.stringify(newOpinion));

            opinions.push(newOpinion);

            localStorage.opinions = JSON.stringify(opinions);


            //4. Notify the user
            window.alert("Your opinion has been stored. Look to the console");
            console.log("New opinion added");
            console.log(opinions);

            //5. Reset the form
            myFrmElm.reset(); //resets the form
        }
    </script>

</body>

</html>